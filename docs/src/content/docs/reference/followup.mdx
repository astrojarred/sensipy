---
title: followup - Lookup Table Functions
description: API reference for followup calculation functions.
---

import {Aside} from "@astrojs/starlight/components";

## get_exposure()

Calculate exposure information using pre-computed lookup tables via interpolation.

### Signature

```python
get_exposure(
    event_id: int,
    delay: u.Quantity,
    site: str,
    zenith: int,
    extrapolation_df: pd.DataFrame | str,
    ebl: str | bool,
    config: str = "alpha",
    duration: int = 1800,
    radius: u.Quantity = 3.0 * u.deg,
    min_energy: u.Quantity = 0.02 * u.TeV,
    max_energy: u.Quantity = 10 * u.TeV,
    event_id_column: str = "event_id",
) -> dict
```

### Parameters

| Parameter          | Type                  | Description                                             |
| ------------------ | --------------------- | ------------------------------------------------------- |
| `event_id`         | `int`                 | GW event identifier from catalog                        |
| `delay`            | `u.Quantity`          | Observation delay from event onset                      |
| `site`             | `str`                 | Observatory site (`"north"` or `"south"`)               |
| `zenith`           | `int`                 | Zenith angle in degrees (20, 40, or 60)                 |
| `extrapolation_df` | `pd.DataFrame \| str` | Lookup DataFrame or filepath                            |
| `ebl`              | `str \| bool`         | EBL model name or True/False                            |
| `config`           | `str`                 | Telescope configuration (default: `"alpha"`)            |
| `duration`         | `int`                 | IRF duration in seconds (default: `1800`)               |
| `radius`           | `u.Quantity`          | Extraction radius (default: `3.0 deg`)                  |
| `min_energy`       | `u.Quantity`          | Minimum energy (default: `0.02 TeV`)                    |
| `max_energy`       | `u.Quantity`          | Maximum energy (default: `10 TeV`)                      |
| `event_id_column`  | `str`                 | Column name for event IDs (default: `"event_id"`) |

### Returns

Dictionary with keys:

- `obs_time`: Required observation time (`u.Quantity`)
- `seen`: Whether detection is possible (`bool`)
- `start_time`, `end_time`: Observation window
- `ebl_model`: EBL model used
- `min_energy`, `max_energy`: Energy range
- Source metadata: `id`, `long`, `lat`, `eiso`, `dist`, `angle`
- `error_message`: Error details if not detectable

### Example

```python
from sensipy import followup
import astropy.units as u
import pandas as pd

lookup_df = pd.read_parquet("./O5_gammapy_observations_v4.parquet")

result = followup.get_exposure(
    event_id=42,
    delay=30 * u.min,
    site="south",
    zenith=20,
    extrapolation_df=lookup_df,
    ebl="franceschini",
)

if result['seen']:
    print(f"Observation time: {result['obs_time']}")
```

## get_row()

Retrieve a specific row from the lookup table matching given criteria.

### Signature

```python
get_row(
    sens_df: pd.DataFrame,
    event_id: int,
    site: str,
    zenith: int,
    ebl: bool = False,
    config: str = "alpha",
    duration: int = 1800,
    event_id_column: str = "event_id",
) -> pd.Series
```

### Example

```python
from sensipy.followup import get_row

row = get_row(
    sens_df=lookup_df,
    event_id=42,
    site="south",
    zenith=20,
    ebl=True,
)
print(row)
```

## extrapolate_obs_time()

Low-level interpolation function for observation times.

### Signature

```python
extrapolate_obs_time(
    event_id: int,
    delay: u.Quantity,
    extrapolation_df: pd.DataFrame,
    filters: dict[str, str | float | int] = {},
    other_info: list[str] = [],
    event_id_column: str = "event_id",
) -> dict
```

### Parameters

- `event_id`: Event identifier
- `delay`: Observation delay
- `extrapolation_df`: Lookup table
- `filters`: Additional filtering criteria (dict)
- `other_info`: Additional fields to include in output (list)
- `event_id_column`: Event ID column name

### Example

```python
from sensipy.followup import extrapolate_obs_time
import astropy.units as u

result = extrapolate_obs_time(
    event_id=42,
    delay=100 * u.s,
    extrapolation_df=lookup_df,
    filters={'site': 'south', 'zenith': 20},
    other_info=['long', 'lat', 'eiso'],
)
```

## get_sensitivity()

Create a `Sensitivity` object from lookup table data.

### Signature

```python
get_sensitivity(
    event_id: int,
    sens_df: pd.DataFrame,
    site: str,
    zenith: int,
    ebl: bool = False,
    config: str = "alpha",
    duration: int = 1800,
    radius: u.Quantity = 3.0 * u.deg,
    min_energy: u.Quantity = 0.02 * u.TeV,
    max_energy: u.Quantity = 10 * u.TeV,
    event_id_column: str = "event_id",
) -> Sensitivity
```

### Example

```python
from sensipy.followup import get_sensitivity
import astropy.units as u

sens = get_sensitivity(
    event_id=42,
    sens_df=lookup_df,
    site="south",
    zenith=20,
    ebl=True,
    radius=3.0 * u.deg,
)
```

<Aside type="tip">
  For most use cases, `get_exposure()` is sufficient. Use the other functions
  for custom workflows or debugging.
</Aside>

## Related

- [Followup Calculations Guide](/getting_started/followups)
- [Followup Analysis Tutorial](/tutorials/followup_analysis)
- [Sensitivity API](/reference/sensitivity)
