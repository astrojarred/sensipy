---
title: Followup Analysis
description: Tutorial on quick exposure calculations using pre-computed lookup tables.
---

import {Aside, Steps, Tabs, TabItem} from "@astrojs/starlight/components";

## Objective

This tutorial demonstrates how to use pre-computed lookup tables for fast exposure time estimatesâ€”ideal for real-time GW alert response and large parameter studies. For comprehensive details about followup calculations, see the [Followup Calculations Guide](/getting_started/followups).

## Prerequisites

- Access to a pre-computed lookup table (Parquet or CSV file)
- Basic understanding of the observation workflow (see [Basic Workflow](./basic_workflow))

<Aside type="note">
  Pre-computed lookup tables are **not included** with sensipy. Contact
  maintainers for access to CTA O5 catalogs. Sample lookup tables are available
  in the package data for testing.
</Aside>

## Basic Followup Query

<Steps>

1. **Import and Load Lookup Table**

   ```python
   from sensipy import followup
   import astropy.units as u
   import pandas as pd

   # Load the lookup table (do this once and reuse)
   # Using sample lookup table included with sensipy
   from sensipy.util import get_data_path
   lookup_path = get_data_path("mock_data/sample_lookup_table.parquet")
   lookup_df = pd.read_parquet(lookup_path)

   print(f"Loaded {len(lookup_df)} pre-computed observations")
   print(f"Columns: {list(lookup_df.columns)}")
   ```

2. **Query for a Specific Event**

   ```python
   # Get exposure for event ID 1 observed after a 10-second delay
   result = followup.get_exposure(
       event_id=1,
       delay=10 * u.s,
       lookup_df=lookup_df,
       irf_site="north",
       irf_zenith=60,
       irf_ebl_model="franceschini",
   )

   # Display results
   if result['seen']:
       print(f"Event 1 is detectable!")
       print(f"  Required observation time: {result['obs_time']}")
       print(f"  Start time: {result['start_time']}")
       print(f"  End time: {result['end_time']}")
   else:
       print(f"Event 1 is not detectable")
   ```

</Steps>

## Scanning Multiple Events

Query many events quickly:

```python
from sensipy import followup
from sensipy.util import get_data_path
import astropy.units as u
import pandas as pd

# Use sample lookup table included with sensipy
lookup_path = get_data_path("mock_data/sample_lookup_table.parquet")
lookup_df = pd.read_parquet(lookup_path)

# Get all unique event IDs
event_ids = lookup_df['event_id'].unique()[:10]  # First 10

delay = 30 * u.min
detectable_count = 0

for event_id in event_ids:
    result = followup.get_exposure(
        event_id=event_id,
        delay=delay,
        lookup_df=lookup_df,
        irf_site="south",
        irf_zenith=20,
        irf_ebl_model="franceschini",
    )

    if result['seen']:
        detectable_count += 1

print(f"Detection fraction: {detectable_count / len(event_ids) * 100:.1f}%")
```

<Aside type="note">
  For more examples including delay scans, parameter space exploration, and
  performance optimization, see the [Followup Calculations Guide](/getting_started/followups).
</Aside>

## Next Steps

- See the [Followup Calculations Guide](/getting_started/followups) for:
  - Delay time scans and finding optimal observation windows
  - Parameter space exploration
  - Comparing with full simulation
  - Performance optimization (caching, pre-filtering)
  - Creating custom lookup tables
  - Helper functions (`get_row`, `extrapolate_obs_time`)
  - Troubleshooting tips
- Review [Simulating Observations](./simulating_observations) for full simulation details
- Check the [Followup API Reference](/reference/followup) for detailed documentation
