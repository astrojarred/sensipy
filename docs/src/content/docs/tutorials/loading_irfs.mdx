---
title: Loading IRFs
description: Working with Instrument Response Functions using the IRFHouse class.
---

import {Aside, Steps, Tabs, TabItem} from "@astrojs/starlight/components";

## Objective

Learn how to load and manage Instrument Response Functions (IRFs) for CTA using the `IRFHouse` class.

## What are IRFs?

Instrument Response Functions (IRFs) describe the performance of a gamma-ray telescope under specific observing conditions. They include:

- **Effective area**: How sensitively the telescope collects photons
- **Point spread function (PSF)**: Angular resolution
- **Energy dispersion**: Energy resolution
- **Background rates**: Expected background counts

## The IRFHouse Class

The `IRFHouse` class manages multiple IRF files and provides a simple interface to load specific configurations.

### Basic Usage

<Steps>

1. **Initialize IRFHouse**

   ```python
   from sensipy.ctaoirf import IRFHouse

   # Point to your IRF root directory
   house = IRFHouse(base_directory="./IRFs/CTAO")
   ```

2. **Load a Specific IRF**

   ```python
   irf = house.get_irf(
       site="south",                # "north" or "south"
       configuration="alpha",        # "alpha", "omega", or "alpha_lst"
       zenith=20,                    # 20, 40, or 60 degrees
       duration=1800,                # 1800, 18000, or 180000 seconds
       azimuth="average",           # "north", "south", or "average"
       version="prod5-v0.1",        # IRF production version
   )

   print(irf)
   ```

</Steps>

## IRF Parameters

### Site

| Value     | Description                                           |
| --------- | ----------------------------------------------------- |
| `"south"` | CTA South (Paranal, Chile) - better for southern sky  |
| `"north"` | CTA North (La Palma, Spain) - better for northern sky |

<Aside type="tip">
  Use "south" for most extragalactic transients and Galactic Center
  observations.
</Aside>

### Configuration

| Value         | Description                    | Telescopes                       |
| ------------- | ------------------------------ | -------------------------------- |
| `"alpha"`     | Alpha configuration (baseline) | 4 LSTs, 25 MSTs, 70 SSTs (South) |
| `"omega"`     | Omega configuration            | Different layout                 |
| `"alpha_lst"` | Alpha LST-only                 | 4 LSTs only                      |

### Zenith Angle

Supported values: `20`, `40`, `60` (degrees)

Lower zenith = better sensitivity (source closer to zenith)

### Duration

IRF observation time: `1800`, `18000`, `180000` (seconds)

This is the duration for which the IRF was calculated, NOT your actual observation time.

### Azimuth

| Value       | Description                    |
| ----------- | ------------------------------ |
| `"average"` | Azimuth-averaged (recommended) |
| `"north"`   | Northern azimuth               |
| `"south"`   | Southern azimuth               |

### Version

| Value          | Description                            |
| -------------- | -------------------------------------- |
| `"prod5-v0.1"` | Production 5 version 0.1 (recommended) |
| `"prod3b-v2"`  | Production 3b version 2 (legacy)       |

## Examples

### Quick Select Examples

<Tabs>
  <TabItem label="Optimal Sensitivity">
    ```python
    # Best sensitivity: South, low zenith, alpha config
    irf = house.get_irf(
        site="south",
        configuration="alpha",
        zenith=20,  # Low zenith
        duration=1800,
        azimuth="average",
        version="prod5-v0.1",
    )
    ```
  </TabItem>

{" "}
<TabItem label="High Zenith">
  ```python # Higher zenith (worse sensitivity, but more sky coverage) irf =
  house.get_irf( site="north", configuration="alpha", zenith=60, # High zenith
  duration=1800, azimuth="average", version="prod5-v0.1", ) ```
</TabItem>

  <TabItem label="Northern Site">
    ```python
    # CTA North for northern hemisphere sources
    irf = house.get_irf(
        site="north",
        configuration="alpha",
        zenith=40,
        duration=1800,
        azimuth="average",
        version="prod5-v0.1",
    )
    ```
  </TabItem>
</Tabs>

### Loading Multiple IRFs

```python
from sensipy.ctaoirf import IRFHouse

house = IRFHouse(base_directory="./IRFs/CTAO")

# Load IRFs for different configurations
irfs = {}

for site in ["north", "south"]:
    for zenith in [20, 40, 60]:
        key = f"{site}_z{zenith}"
        irfs[key] = house.get_irf(
            site=site,
            configuration="alpha",
            zenith=zenith,
            duration=1800,
            azimuth="average",
            version="prod5-v0.1",
        )

print(f"Loaded {len(irfs)} IRF configurations")
```

## IRF Object Properties

The `IRF` object provides useful information:

```python
from sensipy.ctaoirf import IRFHouse

house = IRFHouse(base_directory="./IRFs/CTAO")
irf = house.get_irf(
    site="south",
    configuration="alpha",
    zenith=20,
    duration=1800,
    azimuth="average",
    version="prod5-v0.1",
)

# Access IRF properties
print(f"Filepath: {irf.filepath}")
print(f"Site: {irf.site}")
print(f"Configuration: {irf.configuration}")
print(f"Zenith: {irf.zenith}")
print(f"Duration: {irf.duration}")
print(f"Version: {irf.version}")

# Energy limits
energy_min, energy_max = irf.energy_limits
print(f"Energy range: {energy_min} to {energy_max}")

# String representation
print(irf)  # Formatted summary
```

## Verifying Your IRF Setup

Use `check_all_paths()` to verify all expected IRF files exist:

```python
house = IRFHouse(base_directory="./IRFs/CTAO", check_irfs=True)

# This will check all paths and report missing files
house.check_all_paths()
```

<Aside type="caution">
  Setting `check_irfs=True` during initialization will automatically verify IRF
  files exist, which may slow down initialization if you have many IRF files.
</Aside>

## Using IRFs with Enums

You can use enums for type safety:

```python
from sensipy.ctaoirf import IRFHouse, Site, Zenith, Duration, Configuration, Azimuth, Version

house = IRFHouse(base_directory="./IRFs/CTAO")

irf = house.get_irf(
    site=Site.south,
    configuration=Configuration.alpha,
    zenith=Zenith.z20,
    duration=Duration.t1800,
    azimuth=Azimuth.average,
    version=Version.prod5_v0p1,
)
```

## Troubleshooting

**Problem**: `FileNotFoundError` when loading IRF

**Solution**:

- Verify IRF files are downloaded and extracted
- Check the directory structure matches the expected format
- Ensure `base_directory` points to the root IRF directory

---

**Problem**: "IRF version not found"

**Solution**:

- Verify you have the requested IRF version downloaded
- Check the version string matches exactly (e.g., "prod5-v0.1" not "prod5v0.1")

## Next Steps

- Learn [Calculating Sensitivity](./calculating_sensitivity) using these IRFs
- See [Basic Workflow](./basic_workflow) for complete example
- Check [IRF API Reference](/reference/ctaoirf) for detailed documentation
